version: '3.8'

services:
  bali-report:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - PORT=3000
      # Add production environment variables here
      - XAI_API_KEY=${XAI_API_KEY:-}
      - MAILCHIMP_API_KEY=${MAILCHIMP_API_KEY:-}
      - MAILCHIMP_AUDIENCE_ID=${MAILCHIMP_AUDIENCE_ID:-}
      - MAILCHIMP_SERVER_PREFIX=${MAILCHIMP_SERVER_PREFIX:-}
      - GOOGLE_ANALYTICS_ID=G-K0VX8HVYE5
      - GOOGLE_ADSENSE_CLIENT=ca-pub-3235214437727397
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:3000/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s